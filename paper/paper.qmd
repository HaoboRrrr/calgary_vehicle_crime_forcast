---
title: "Focasting The Trend of Vehicle Related Crime In Calgary In 2025"
subtitle: "An Analysis of Calgary's Crime Count From 2018 to 2024"
author: 
  - Haobo Ren
thanks: "Code and data are available at: https://github.com/HaoboRrrr/calgary_vehicle_crime_forcast"
date: 23-November-2024
date-format: long
abstract: "Vehicle-related crime is a long-standing challenge to urban security, so accurate prediction is necessary to effectively allocate police resources and develop security policies. This study examines trends in vehicle-related crime in Calgary, Canada, focusing on two types of crime: Theft of vehicle and Theft from vehicle. A Bayesian regression model is fit to historical crime data from January 2018 to October 2024, accounting for seasonal variations (months), long-term trends (years), and differences between crime categories. The usefulness of Bayesian modeling for crime trend forecasting is demonstrated by this analysis, providing law enforcement and policymakers practical insights to foresee and handle long-term and seasonal crime trends."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(knitr)
library(arrow)

cleaned_data <- read_parquet(here("data/02-analysis_data/calgary_crime.parquet"))
```


# Introduction

Urban crime is an ongoing problem compromising public confidence, economic stability, and safety. Among the several types of crimes, vehicle-related offenses include theft of vehicles and theft from vehicles remain a major issue in urban areas across the country. These crimes disturb people's life but also burden local governments and law enforcement. Over the years, Calgary, Canada, has seen varying patterns in vehicle-related crimes, which raises issues regarding future developments of these trends. Designing effective preventive plans, maximizing resource allocation, and guaranteeing community safety all depend on an awareness of current trends and future crime count prediction. This study forecasts vehicle-related crime patterns in Calgary up until 2025, therefore addressing these issues.

Analyzing and projecting monthly crime counts for theft from vehicles and theft of vehicles in Calgary is the main aim of this study. I created a Bayesian regression model to assess the effects of time (year and month) and crime category on reported crime counts using historical data spanning January 2018 through October 2024. Offering a comprehensive knowledge of how vehicle-related crimes have developed and may continue to alter in the near future, the model catches both long-term patterns and seasonal changes. The research also offers category-specific forecasts, therefore stressing variations in the seasonal and temporal trends of theft from and of vehicles.

The analysis reveals a continued decline in vehicle-related crimes in Calgary, with a mean change of -60.5 each year, and notable mean differences of -454.8 between the two categories. Theft from vehicles is anticipated to show cyclical surges in the summer months, indicating possible opportunistic habits. Conversely, vehicle theft exhibits a more stable decline throughout the course of the year. The data indicate that, although overall vehicle-related crimes are down, seasonal surges in certain categories persist as a problem for policymakers and law enforcement to tackle, for example, the crime count of Theft From Vehicle in August is expected larger than January by 159.4.

The study is significant for its role in proactive crime prevention and resource optimization. This study offers precise and comprehensible forecasts, providing policymakers and law enforcement with evidence-based insights to inform decision-making. This study addresses a significant research gap and enhances public safety in Calgary.

#Telegraphing paragraph: The remainder of this paper is structured as follows. @sec-data....


# Data {#sec-data}

## Overview

The raw dataset obtained from Open Data Calgary[@OpenCalgary] was recorded and updated monthly by the Calgary Police Service. The data is considered cumulative as late-reported incidents are often received well after an offence has occurred. An incident is either reported just after the crime happened, or reported on the Calgary Police Service[@calgarypolice].

The data analysis and visualization is done in R[@citeR] with the following Packages: tidyverse[@tidy], janitor[@janitor], arrow[@arrow], rstanarm[@rstanarm], ggplot2[@ggplot2], dplyr[@dplyr], here, knitr.

## Measurement
	
The data reflects reported crime incidents across Calgary, categorized by community, crime type, and temporal details (year and month). Each row in the dataset represents a summary of crime counts for a specific category and community within a given month and year. The Calgary Police Service serves as the primary source, systematically recording incidents reported by the public. These reports may be filed in several ways, including: immediate Reporting and delayed Reporting.

Crime count quantifies the number of reported incidents of a specific crime and time period and is based on the most serious violation per incident. The count represents and aggregation of individual reports collected by the Calgary Police Services. 

There are limitations in these measurement. Reporting Bias: Not all crimes are reported. Minor incidents or those involving uninsured vehicles may go unreported, leading to underestimation of true crime rates. Cumulative Nature: The inclusion of late-reported incidents makes it challenging to distinguish between crimes that occurred during the reported month versus those that occurred earlier.

By understanding how this dataset measures real-world crime phenomena, we can more confidently interpret the insights and predictions derived from it.

## Data Examination {#sec-dataexam}

The raw data from Open Data has five columns and 75,595 rows, the column names are displayed below: 

```{r}
#| echo: false
#| warning: false
raw_data <- read_csv(here("data/01-raw_data/raw_data.csv"))

# Get the column names of your raw data
column_names <- colnames(raw_data)

# Convert the column names to a data frame for kable
column_df <- as.data.frame(column_names)

# Display with kable
kable(column_df)
```
- Community: The dataset is spatially disaggregated into Calgary's various communities

Numeric Variable:

- Year: The year of each record indicate when the incidents were reported. 

Categorical Variable:

- Category: Each entry is categorized into distinct crime types.

- month: The month of each incidents recorded. Range from 1-12 repeatedly each year

Response Variable:

- Crime Count: This variable quantifies the number of reported incidents of a specific crime type (e.g., theft from or of vehicles) within a given community and time period. 

## Data Cleaning

Several steps was taken for better analysis of vehicle-related trend in Calgary. First, clean the names of all the columns. Second, the raw dataset contained granular records categorized by Community and specific details. These were aggregated to provide summarized counts of crimes (crime_count) by category, year, and month to align with analysis requirements. Third, a new time column was introduced in the cleaned data, combining year and month into a single date field (YYYY-MM-DD). This was essential for time-series analysis and visualization. Last, filter out the categories related to vehicle.

## Cleaned Data

The first 6 rows of the cleaned dataset are shown in @tbl-cleaned-data.

```{r}
#| label: tbl-cleaned-data
#| tbl-cap: Head of cleaned Calgary Crime data 
#| echo: false
#| warning: false

kable(head(cleaned_data))
```

## Response Variable

### Crime count of Theft FROM Vehicle

Summary statistics of Crime count of Theft FROM Vehicle are shown in the @tbl-response-theftfromvehicle

```{r}
#| label: tbl-response-theftfromvehicle
#| tbl-cap: Summary Statitic of crime_count(Theft FROM Vehicle)
#| echo: false
#| warning: false

kable(cleaned_data %>% filter(category == "Theft FROM Vehicle") %>% select(crime_count) %>% summary(crime_count))
```

The response variable, crime_count, represents the number of reported incidents of theft from vehicles within Calgary. The summary statistics reveal a significant variability in the crime counts, ranging from a minimum of 120 to a maximum of 1,619 reported cases. The median value is 916, indicating that half of the recorded months experienced fewer than 916 thefts, while the other half exceeded this value. The mean crime count, at 932.7, is slightly higher than the median, suggesting the presence of months with particularly high crime counts that may be skewing the average. The interquartile range (IQR), spanning from 788.2 (1st quartile) to 1,105.5 (3rd quartile), highlights the central tendency of crime occurrences, with most months falling within this range. These statistics emphasize the fluctuating nature of vehicle thefts in Calgary and provide a foundational understanding for modeling and forecasting future trends.

### Crime count of Theft OF Vehicle

Summary statistics of Crime count of Theft FROM Vehicle are shown in the @tbl-response-theftofvehicle

```{r}
#| label: tbl-response-theftofvehicle
#| tbl-cap: Summary Statitic of crime_count(Theft OF Vehicle)
#| echo: false
#| warning: false

kable(cleaned_data %>% filter(category == "Theft OF Vehicle") %>% select(crime_count) %>% summary(crime_count))
```


The response variable, crime_count, for Theft OF Vehicle incidents reflects the monthly reported counts of vehicles being stolen in Calgary. The dataset's summary statistics indicate that the crime counts range from a minimum of 146 to a maximum of 651 incidents. The median count is 424.5, suggesting that half of the months have fewer than 425 thefts, while the other half exceed this value. Interestingly, the mean crime count is 422.5, closely aligned with the median, suggesting a relatively symmetric distribution of the data. The interquartile range (IQR) spans from 361.2 (1st quartile) to 469.0 (3rd quartile), indicating that most monthly counts are concentrated within this range. These figures highlight the scale and regularity of vehicle theft in Calgary and form an essential basis for analyzing and forecasting trends in such crimes.

## Predictor Variable

### year

The variable year represents the timeline over which the crime data is recorded, providing insight into how vehicle-related crime counts have changed annually. By analyzing the data across different years, we can observe any long-term trends, such as consistent increases, decreases, or fluctuations in vehicle thefts. This variable helps us understand whether certain years experienced higher crime rates due to factors like economic conditions, population changes, or other external influences.

### month and category

The variables month and category provide a detailed view of how vehicle-related crimes are distributed across time and crime types. Month captures seasonal variations, showing how crime rates fluctuate throughout the year. For example, there might be a tendency for higher crime counts during certain seasons, such as summer or winter, influenced by weather conditions or holiday activities. Category distinguishes between "Theft FROM Vehicle" and "Theft OF Vehicle," allowing us to compare the frequency and patterns of these two crime types. Together, these variables highlight differences in the nature and timing of vehicle-related crimes, offering valuable insights into their temporal and categorical distributions.

## Trend of The Two Crime

The trend of Theft FROM Vehicle and Theft OF Vehicle are shown in @fig-combined-trend

```{r}
#| label: fig-combined-trend
#| tbl-cap: Trend of The Two Crime Combined
#| echo: false
#| warning: false
# Plot combined trends
ggplot(cleaned_data, aes(x = time, y = crime_count, color = category)) +
  geom_line() +
  labs(
    title = "Trend of Theft FROM Vehicle and Theft OF Vehicle",
    x = "Time",
    y = "Crime Count",
    color = "Category"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


The trends for "Theft FROM Vehicle" and "Theft OF Vehicle" reveal distinct patterns over time. "Theft FROM Vehicle" consistently shows higher crime counts compared to "Theft OF Vehicle," indicating that it is a more prevalent issue. The trend for "Theft FROM Vehicle" demonstrates significant fluctuations, with peaks around 2019 and a general decline afterward, suggesting a reduction in these incidents in more recent years. In contrast, "Theft OF Vehicle" exhibits a relatively stable pattern with smaller variations over time. Although it remains less frequent than "Theft FROM Vehicle," its counts appear to decrease gradually, particularly after 2022. Both categories show declining trends toward the end of the observed period, which could reflect successful crime prevention measures or other external influences.

# Model

The Bayesian regression model was developed to analyze and forecast the trends of vehicle-related crimes in Calgary, focusing on the categories "Theft FROM Vehicle" and "Theft OF Vehicle." The primary goal of this modeling is to understand the relationship between crime counts and key predictors such as time (year and month) and crime categories, as well as their interactions. By incorporating temporal and categorical variables, the model seeks to capture long-term trends, seasonal patterns, and differences between the two types of crimes. Ultimately, the model provides a foundation for projecting future crime rates, offering valuable insights that can support strategic decision-making and the development of targeted crime prevention initiatives for 2025 and beyond.

Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

The Bayesian regression model is set up to examine the relationship between vehicle-related crime counts and the selected predictors. The response variable, $y_i$, represents the observed crime count for the i-th observation, where each observation corresponds to a specific month, year, and crime category. The predictors include a numeric variable for year, categorical variables for month and category, as well as interaction terms (category:month and category:year) to capture how crime patterns differ between the two crime types over time and across seasons.

The model assumes the form:

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in 

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

```

```{r}
#| echo: false
#| eval: true

#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

```




# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]


```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

```



\newpage


# References


